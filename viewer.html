<!DOCTYPE html>
<html>
<head><title>Viewer</title></head>
<body>
  <h2>Viewer</h2>
  <video id="remoteVideo" autoplay playsinline></video>

  <script src="https://unpkg.com/peerjs@1.4.7/dist/peerjs.min.js"></script>
  <script>
    // Fixed peer ID for viewer
    const peer = new Peer('viewer-peer');
    const remoteVideo = document.getElementById('remoteVideo');

    peer.on('open', () => {
      console.log('Viewer Peer ready with ID:', peer.id);

      // Automatically call sender-peer on peer open
      const call = peer.call('sender-peer', null);

      call.on('stream', (remoteStream) => {
        console.log('Received remote stream');
        remoteVideo.srcObject = remoteStream;
      });

      call.on('error', (err) => {
        console.error('Call error:', err);
      });

      call.on('close', () => {
        console.log('Call ended');
        remoteVideo.srcObject = null;
      });
    });
  </script>
</body>
</html>
